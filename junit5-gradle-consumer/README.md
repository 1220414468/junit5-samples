# junit5-gradle-consumer

The `junit5-gradle-consumer` project demonstrates how to run tests based on
JUnit 5 snapshots using Gradle with the help of a very basic JUnit Gradle plugin.

## Enabling the JUnit Gradle Plugin

To use the JUnit Gradle plugin, you first need to configure `build.gradle` as follows.

```groovy
buildscript {
	repositories {
		mavenCentral()
	}
	dependencies {
		classpath 'org.junit:junit-gradle:5.0.0-SNAPSHOT'
	}
}

apply plugin: 'org.junit.gen5.gradle'
```

## Configuring the JUnit Gradle Plugin

Once the JUnit Gradle plugin has been applied, you can configure it as follows.

```groovy
junit5 {
	version '5.0.0-SNAPSHOT'
	runJunit4 true
	matchClassName '.*Test'
	tags {
		// include 'fast'
		// exclude 'slow'
	}
}

```

Setting `runJunit4` to `true` instructs the JUnit Gradle plugin to run JUnit 4
based tests as well. However, you will still need to configure a
`testCompile` dependency on JUnit 4 in your project similar to the following.

```groovy
dependencies {
	testCompile('junit:junit:4.12')
}
```

If you supply a _tag_ via `tags {include ...}`, the JUnit Gradle plugin
will only run JUnit 5 based tests that are _tagged_ accordingly via the `@Tag`
annotation.

## Executing JUnit 5 Tests

Once the JUnit Gradle plugin has been applied and configured, you have a new
`junit5Test` task at your disposal.

Invoking `gradlew clean junit5Test` (or `gradlew clean check`) from the
command line will execute all tests within the project whose class names
match the pattern `.*Test`. This will result in output similar to the
following:

```
:junit5Test

Test run finished after 50 ms
[         3 tests found     ]
[         2 tests started   ]
[         1 tests skipped   ]
[         0 tests aborted   ]
[         2 tests successful]
[         0 tests failed    ]

BUILD SUCCESSFUL
```

If you comment out the `@Disabled` annotation on `SecondTest#mySecondTest()`, you
will then see the build fail with output similar to the following:

```
:junit5Test

Test failures (1):
  junit5:com.example.project.SecondTest:mySecondTest
    com.example.project.SecondTest#mySecondTest
    => Exception: 2 is not equal to 1 ==> expected:<2> but was:<1>

Test run finished after 50 ms
[         3 tests found     ]
[         3 tests started   ]
[         0 tests skipped   ]
[         0 tests aborted   ]
[         2 tests successful]
[         1 tests failed    ]

:junit5Test FAILED

FAILURE: Build failed with an exception.

* What went wrong:
Execution failed for task ':junit5Test'.
> Process 'command '/Library/Java/JavaVirtualMachines/jdk1.8.0_66.jdk/Contents/Home/bin/java'' finished with non-zero exit value 1
```

**Note**: the _exit value_ corresponds to the number of _tests failed_.

### Current Limitations

- Even though the build will fail if a test fails, the results will not
  be included in the test report generated by Gradle.
- With `runJunit4` set to `true`, the JUnit Gradle plugin takes over the
  responsibility of running JUnit 4 tests, and the standard Gradle `test`
  task will no longer execute JUnit 3 or JUnit 4 tests. Consequently, the
  results for JUnit 4 tests will not be included in the standard test report
  generated by Gradle.
